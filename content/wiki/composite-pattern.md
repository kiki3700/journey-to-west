---
title: 컴포지트 패턴
slug: "composite-pattern"
---

## 정의

- 객체를 트리로 구성해서 `부분-전체 계층구조`로 구현한다. 컴포지트 패턴을 사용하면 클라이언트 객체에서 개별 객체와 복합 객체를 똑같은 방법으로 다룰 수 있다.
- 컴포지트 패턴을 사용하면, 개별 객체와 복합 객체를 모두 담을 수 있는 구조를 제공할 수 있다.
- Node: 자식 원소가 있는 원소
- Leaf: 자식 원소가 없는 원소

### 부분-전체 계층 구조

- 부분(leaf, node)들이 모두 계층을 이루고 있지만, 모든 부분을 묶어서 전체로 다룰 수 있는 구조.
- 특징
  - 재귀적 구조: 부분 객체도 전체 객체의 역할을 할 수 있으며, 전체 객체는 다시 부분 객체를 포함을 수 있다.
  - 일관된 인터페이서: 부분 객체와 전체 객체는 동일한 인터페이스를 구현한다. 클라이언트가 이들 객체를 동일한 방식으로 사용할 수 있게 한다.
  - 계층적 트리 구조: 부분-전체 계층 구조는 트리형태의 계층 구조를 가지며, 각 노드는 부분 객체 또는 전체 객체일 수 있다.

## 구조

![composite-pattern-uml](../../src/images/composite-pattern.jpg)

- client는 `Component` 인터페이스를 통해 복합 객체 `Composite`나 항목인 `leaf` 구분 없이 모두 일관된 형태 방식으로 다룰 수 있다.
- `Component`는 복합 객체의 인터페이스를 모두 구현하여, 투명성을 갖게한다.
- `Leaf`는 구현 방법에 따라 다르지만 항목의 행동만을 정의한다.
- `Composite`는 자식이있는 구성요소의 행동을 정의하고, 필요시 `leaf`와 관련된 기능도 구현한다.

## 구현 방식

![composite-pattern-implement-uml](../../src/images/composite-pattern-implement.jpg)

- 자식 관련 연산을 인터페이스에서 정의하여 `Composite` 클래스에서 구현한다. 이를 통해 균일한 인터페이스를 제공한다. 구현에 있어서 사용하지 않는 메서드는 예외를 발생시키거나 적절한 기본값을 반환한다.
- 자식 관련 연산은 `Composite`클래스에 구현한다. 클라이언트는 `Leaf`와 `Composite`객체를 다르게 처리해야한다.

## 장단점

### 장점

- 투명성을 확보한다. 소프트웨어 설계에서 투명성은 1. `인터페이스의 일관성`, 2. `구현 세부사항의 숨김`을 의미한다.
- 확장성: 새로운 부분 객체나 전체 객체를 쉽개 추가할 수 있다.
- 재사용성: 부분 객체와 전체 객체를 동일한 방식으로 처리할 수 있어 코드 유연성이 올라간다.

### 단점

- 안정성이 떨어진다.
- 단일 책임 원칙을 포기한다.(투명성을 확보한다.)
